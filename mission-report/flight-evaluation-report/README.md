![Abort-Mission](../../.github/assets/Abort-Mission-logo_export_transparent_640.png)

[![GitHub license](https://img.shields.io/github/license/nagyesta/abort-mission?color=informational)](https://raw.githubusercontent.com/nagyesta/abort-mission/main/LICENSE)
[![Java version](https://img.shields.io/badge/Java%20version-8-yellow?logo=java)](https://img.shields.io/badge/Java%20version-8-yellow?logo=java)
[![latest-release](https://img.shields.io/github/v/tag/nagyesta/abort-mission?color=blue&logo=git&label=releases&sort=semver)](https://github.com/nagyesta/abort-mission/releases)
[![JavaCI](https://img.shields.io/github/workflow/status/nagyesta/abort-mission/JavaCI?logo=github)](https://img.shields.io/github/workflow/status/nagyesta/abort-mission/JavaCI?logo=github)

# Flight Evaluation Report Generator

[![codecov flighteval](https://img.shields.io/codecov/c/github/nagyesta/abort-mission?label=Coverage:%20FlightEvaluationReport&flag=flighteval&token=I832ZCIONI)](https://img.shields.io/codecov/c/github/nagyesta/abort-mission?label=Coverage:%20FlightEvaluationReport&flag=flighteval&token=I832ZCIONI)

Please find the essentials below or check out [the wiki](https://github.com/nagyesta/abort-mission/wiki) for more
details.

# Purpose

This Spring Boot application is responsible for turning the JSON execution reports generated by Abort-Mission into more
convenient, HTML reports.

Depending on your setup and how you plan to use the information collected, you can either use the Jar alone, or you may
want to integrate it into your build pipeline and automate the report generation as described below.

# Quick-start

## Gradle

Create a custom configuration

```groovy
configurations {
    missionReport
}
```

Add the dependency on this module

```groovy
dependencies {
    missionReport 'com.github.nagyesta.abort-mission.reports:abort.flight-evaluation-report:+'
}
```

Create a task to execute the resolved Jar

```groovy
task generateMissionReport(type: JavaExec) {
    inputs.file(file("${buildDir}/reports/abort-mission/abort-mission-report.json"))
    outputs.file(file("${buildDir}/reports/abort-mission/abort-mission-report.html"))

    main = "org.springframework.boot.loader.JarLauncher"
    classpath configurations.missionReport
    args = ["--report.input=${buildDir}/reports/abort-mission/abort-mission-report.json",
            "--report.output=${buildDir}/reports/abort-mission/abort-mission-report.html"]
    logging.captureStandardOutput LogLevel.INFO
    logging.captureStandardError LogLevel.ERROR
}
//make sure it is running after the tests
test.finalizedBy generateMissionReport
```

## Maven

Define an exec plugin and let it resolve and run the Jar for you.

**Note:** The XML below is only a workaround for the time being. Please be aware of the known limitation preventing it
from generating the report in case of test failures happened. This is due to the fact, that surefire stops execution
already.

```xml

<project>
    ...
    <build>
        <plugins>
            <plugin>
                <groupId>org.codehaus.mojo</groupId>
                <artifactId>exec-maven-plugin</artifactId>
                <version>3.0.0</version>
                <executions>
                    <execution>
                        <goals>
                            <goal>exec</goal>
                        </goals>
                        <phase>test</phase>
                    </execution>
                </executions>
                <configuration>
                    <includeProjectDependencies>false</includeProjectDependencies>
                    <includePluginDependencies>true</includePluginDependencies>
                    <executable>java</executable>
                    <arguments>
                        <argument>-jar</argument>
                        <argument>
                            ${settings.localRepository}/com/github/nagyesta/abort-mission/reports/abort.flight-evaluation-report/2.1.0/abort.flight-evaluation-report-2.1.0.jar
                        </argument>
                        <argument>
                            --report.input=${project.build.directory}/reports/abort-mission/abort-mission-report.json
                        </argument>
                        <argument>
                            --report.output=${project.build.directory}/reports/abort-mission/abort-mission-report.html
                        </argument>
                    </arguments>
                </configuration>
                <dependencies>
                    <dependency>
                        <groupId>com.github.nagyesta.abort-mission.reports</groupId>
                        <artifactId>abort.flight-evaluation-report</artifactId>
                        <version>2.1.0</version>
                        <type>jar</type>
                    </dependency>
                </dependencies>
            </plugin>
        </plugins>
    </build>
    ...
</project>
```

# Configuration

| Argument name    | Type    | Description                                          |
| ---------------- | ------- | ---------------------------------------------------- |
| --report.input   | File    | The path of the input JSON file                      |
| --report.output  | File    | The path of the output HTML file                     |
| --report.relaxed | boolean | Selects between relaxed and strict schema validation |
